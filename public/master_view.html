<!Doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Master View</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" type="text/css" media="screen" href="css/salesStyle.css" />

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
</head>
<body>
      <!--- side nav-->
   <div class="nav-side-menu">
      <div class="brand brand-color">
          <h4>Uniform Inventory</h4>
      </div>
      <i class="fa fa-bars fa-2x toggle-btn" data-toggle="collapse" data-target="#menu-content"></i>
      <div class="menu-list" id="menu-content">

            <ul id="accordion1" class="menu-content collapse out">

                    <li data-toggle="collapse" data-parent="#accordion1" href="#thirdLink"> <a> <i></i> Sales</a>
    
                        <ul id="thirdLink" class="collapse sub-list">
                            <li>
                                <a href="/sale/sales_order">Sales Order</a>
                            </li>
                            <li>
                                <a href="/sale/packing_list">Packing List</a>
                            </li>
                            <li>
                                <a href="/sale/commercial_invoice">Commercial Invoice</a>
                            </li>
                            <li>
                                <a href="/sale/reciept_voucher">Reciept Voucher</a>
                            </li>
                        </ul>
                    </li>
                    <li data-toggle="collapse" data-parent="#accordion1" href="#firstLink"> <a> <i></i> Purchase</a>
    
                        <ul id="firstLink" class="collapse sub-list">
                            <li>
                                <a href="/purchase/purchase_order">Purchase Order</a>
                            </li>
                            <li>
                                <a href="/purchase/gr_note">Good Receiving Note / Invoice</a>
                            </li>
    
                            <li>
                                <a href="/purchase/payment_voucher">Vendor Payment</a>
                            </li>
                        </ul>
    
                    </li>
                    <li>
                        <a href="/production">
                            <i></i> Production</a>
                    </li>
                    <li data-toggle="collapse" data-parent="#accordion1" href="#reports"> <a> <i></i> Reports</a>
    
                        <ul id="reports" class="collapse sub-list">
                            <li>
                                <a href="/reports/sales_report">Sales Report</a>
                            </li>
                            <li>
                                <a href="/reports/purchase_report">Purchases Report</a>
                            </li>
    
                            <li>
                                <a href="/reports/production_report">Productions Report</a>
                            </li>
                            <li>
                                <a href="/reports/accounts_report">Accounts Report</a>
                            </li>
                        </ul>
    
                    </li>
    
                    <li>
                        <a href="/master">
                            <i></i> Master Data
                        </a>
                    </li>
    
                    <li>
                        <a href="/master_view">
                            <i></i> Master View
    
                        </a>
                    </li>
    
                    <!-- <li>
                            <a href="/attendance">
                                <i></i> Attendance
                            </a>
                        </li> -->
    
                </ul>
    

      </div>
  </div>
 <!--- side nav-->
 <div id="main">
    <div class="container-fluid">
        <div class="container">

        <div class="row">
                <div class="col-12 text-center">
                    <img src="assets/img/aa-logo.jpg" class=" mx-auto "  style='height:10em' alt="logo">
                </div>
            </div>
        <div class="container-fluid">
            <!-- Nav pills -->
<ul class="nav nav-pills">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="pill" href="#lpo">Active L.P.O's</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="pill" href="#po">Purchase Orders</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="pill" href="#products">Products</a>
        </li>
        <li class="nav-item">
                <a class="nav-link" data-toggle="pill" href="#raw">Raw Items</a>
        </li>
        <li class="nav-item">
                <a class="nav-link" data-toggle="pill" href="#styles">Styles</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="pill" href="#fabrics">Fabrics</a>
        </li>
        <li class="nav-item">
                    <a class="nav-link" data-toggle="pill" href="#vendors">Vendors</a>
                          </li>
        <li class="nav-item">
                        <a class="nav-link" data-toggle="pill" href="#clients">Clients</a>
                      </li>
      </ul>
      <hr>
      
      <!-- Tab panes -->
      <div class="tab-content">
        <div class="tab-pane container active" id="lpo"> <!---- LPOS  -->
            <div class="container-fluid">
                   <h4>All ACTIVE LPOS</h4>
                   <div class="container">
                        <div class="input-group mb-3">
                        <div class="input-group-prepend">
                                <span class="input-group-text">Search</span>
                              </div>
                              <input type="text" class="form-control" placeholder="search query?" id='lpos_q'  onkeyup="search('lpos_q','lpos_table')">
                            </div>
                           <table class="table table-dark table-striped">
                                   <thead>
                                     <tr>
                                       <th>lpo#</th>
                                       <th>Ref</th>
                                       <th>Client</th>
                                       <th>Ordered Items</th>
                                       <th>Flag</th>
                                       <th>Date</th>

                                     </tr>
                                   </thead>
                                   <tbody id='lpos_table'>
                                    
                                   </tbody>
                                 </table>
                               
                        
   
                   </div>
               </div>
               <hr>
   
                <!---- LPOS  --></div>
        <div class="tab-pane container fade" id="po">
            <!---- LPOS  -->
            <div class="container-fluid">
                    <h4>All ACTIVE PURCHASING ORDERS</h4>
                    <div class="container">
                            <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                      <span class="input-group-text">Search</span>
                                    </div>
                                    <input type="text" class="form-control" placeholder="search query?" id='pos_q'  onkeyup="search('pos_q','pos_table')">
                                  </div>
                            <table class="table table-dark table-striped">
                                    <thead>
                                      <tr>
                                        <th>P.O#</th>
                                        <th>Ref</th>
                                        <th>Vendor</th>
                                        <th>purchase Items</th>
                                        <th>Flag</th>
                                        <th>Date</th>
 
                                      </tr>
                                    </thead>
                                    <tbody id='pos_table'>
                                     
                                    </tbody>
                                  </table>
                                
                         
    
                    </div>
                </div>
                <hr>
    
                 <!---- LPOS  -->
        </div>
        <div class="tab-pane container fade" id="products"> <!---- items  -->
            <div class="container-fluid">
                <h4>All Products</h4>
                <div class="container">
                        <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                        <span class="input-group-text">Search</span>
                                      </div>
                                      <input type="text" class="form-control" placeholder="search query?" id='items_q'  onkeyup="search('items_q','items_table')">
                                    </div>
                        <table class="table table-dark table-striped">
                                <thead>
                                  <tr>
                                    <th>Name</th>
                                    <th>description</th>
                                    <th>Unit Price</th>
                                  </tr>
                                </thead>
                                <tbody id='items_table'>
                                 
                                </tbody>
                              </table>
                            
                     

                </div>
            </div>
            <hr>

             <!---- Items  -->
           </div>
        <div class="tab-pane container fade" id="raw">  <!---- Raw_items  -->
            <div class="container-fluid">
                    <h4>All Raw Materials</h4>
                    <div class="container">
                            <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                            <span class="input-group-text">Search</span>
                                          </div>
                                          <input type="text" class="form-control" placeholder="search query?" id='raw_q'  onkeyup="search('raw_q','raw_items_table')">
                                        </div>
                            <table class="table table-dark table-striped">
                                    <thead>
                                      <tr>
                                        <th>Name</th>
                                        <th>description</th>
                                        <th>Unit</th>
                                        <th>Unit Price</th>
                                      </tr>
                                    </thead>
                                    <tbody id='raw_items_table'>
                                     
                                    </tbody>
                                  </table>
                                
                         
    
                    </div>
                </div>
                <hr>
    
                 <!---- raw_Items  -->
            </div>
            <div class="tab-pane container fade" id="styles"> <!--- All Styles -->
                <div class="container-fluid">
                       <h4>All Styles</h4>
                       <div class="container">
                            <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                            <span class="input-group-text">Search</span>
                                          </div>
                                          <input type="text" class="form-control" placeholder="search query?" id='styles_q'  onkeyup="search('styles_q','styles_table')">
                                        </div>
                           <div class="row">
                                <table class="table table-dark table-striped">
                                        <thead>
                                          <tr>
                                            <th style="width:20%">Title</th>
                                            <th style="width:15%">Gender</th>
                                            <th style="width:45%">Style Detail</th>
                                            <th style="width:20%">Picture</th>
                                          </tr>
                                        </thead>
                                        <tbody id='styles_table'>
                                         
                                        </tbody>
                                      </table>
        
                           </div>
                           
                               
                       </div>
                   </div>
                   <hr>
               <!--- All Styles -->
               </div>
               <div class="tab-pane container fade" id="fabrics"> <!--- All Fabrics -->
                <div class="container-fluid">
                       <h4>All Styles</h4>
                       <div class="container">
                            <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                            <span class="input-group-text">Search</span>
                                          </div>
                                          <input type="text" class="form-control" placeholder="search query?" id='fabrics_q'  onkeyup="search('fabrics_q','fabrics_table')">
                                        </div>
                               <table class="table table-dark table-striped">
                                       <thead>
                                         <tr>
                                           <th>Fabric Code</th>
                                           <th>Name</th>
                                           <th>Detail</th>
                                           <th>Width</th>
                                           <th>Color</th>
                                         </tr>
                                       </thead>
                                       <tbody id='fabrics_table'>
                                        
                                       </tbody>
                                     </table>
       
                       </div>
                   </div>
                   <hr>
               <!--- All Fabrics -->
               </div>
           
        <div class="tab-pane container fade" id="vendors"> <!--- All Vendor -->
            <div class="container-fluid">
                   <h4>All Vendor</h4>
                   <div class="container">
                        <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                        <span class="input-group-text">Search</span>
                                      </div>
                                      <input type="text" class="form-control" placeholder="search query?" id='vendors_q'  onkeyup="search('vendors_q','vendors_table')">
                                    </div>
                           <table class="table table-dark table-striped">
                                   <thead>
                                     <tr>
                                       <th>Name</th>
                                       <th>Company Name</th>
                                       <th>Street Address</th>
                                       <th>City</th>
                                       <th>Phone</th>
                                       <th>Email</th>
                                     </tr>
                                   </thead>
                                   <tbody id='vendors_table'>
                                    
                                   </tbody>
                                 </table>
   
                   </div>
               </div>
               <hr>
           <!--- All Vendor -->
           </div>
        <div class="tab-pane container fade" id="clients"> <!--- All Client -->
            <div class="container-fluid">
                    <h4>All Client</h4>
                    <div class="container">
                            <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                            <span class="input-group-text">Search</span>
                                          </div>
                                          <input type="text" class="form-control" placeholder="search query?" id='clients_q'  onkeyup="search('clients_q','clients_table')">
                                        </div>
                            <table class="table table-dark table-striped">
                                    <thead>
                                      <tr>
                                        <th>Name</th>
                                        <th>Company Name</th>
                                        <th>Street Address</th>
                                        <th>City</th>
                                        <th>Phone</th>
                                        <th>Email</th>
                                      </tr>
                                    </thead>
                                    <tbody id='clients_table'>
                                     
                                    </tbody>
                                  </table>
    

                  
    
                    </div>
                </div>
                <hr>
            <!--- All Client -->

</div>

      </div>
            
           
        </div>    
            </div>

            </div>
 </div>
           

     
<script src="https://www.gstatic.com/firebasejs/5.5.3/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyA6MZB_05f3iHzNWU9TLBnh4ImCV8l9QKU",
    authDomain: "productionmodule.firebaseapp.com",
    databaseURL: "https://productionmodule.firebaseio.com",
    projectId: "productionmodule",
    storageBucket: "",
    messagingSenderId: "682109476740"
  };
  firebase.initializeApp(config);
</script>
        
<script type="text/javascript" src="jquery-3.3.1.min.js"></script>

<script>
      function load_lpos(){
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      let lpos = JSON.parse(this.responseText).lpos;
      let table=document.getElementById('lpos_table');
      let str='';
      lpos.forEach((lpo)=>{
       let str1=`<table  style='font-size:12px;border:1px solid beige'><tbody>`;
       let items=JSON.parse(lpo.items_array);
       items.forEach((item)=>{
       str1 += `<tr><td>`+item.item+`</td><td>`+item.quantity+`</td><td>`+item.price+`(pkr)</td></tr>`;
       });
       str1 += `</tbody></table>`;
       str += '<tr><td>'+lpo.lpo_number+'</td><td>'+lpo.ref+'</td><td>'+lpo.client+'</td><td>'+str1+'</td><td>'+lpo.flag+'</td><td>'+lpo.date+'</td></tr>'
      });
      table.innerHTML = str;
    }
  };
  xhttp.open("GET", "/get_lpos", true);
  xhttp.send(); 
   }
   function load_pos(){
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      let pos = JSON.parse(this.responseText).pos;
      let table=document.getElementById('pos_table');
      let str='';
      pos.forEach((po)=>{
        let str1=`<table  style='font-size:12px;border:1px solid beige'><tbody>`;
       let items=JSON.parse(po.purchase_array);
       items.forEach((item)=>{
       str1 += `<tr><td>`+item.item+`</td><td>`+item.quantity+`</td><td>`+item.price+`(pkr)</td></tr>`;
       });
       str1 += `</tbody></table>`;
       str += '<tr><td>'+po.po_num+'</td><td>'+po.ref+'</td><td>'+po.vendor+'</td><td>'+str1+'</td><td>'+po.flag+'</td><td>'+po.date+'</td></tr>'
      });
      table.innerHTML = str;
    }
  };
  xhttp.open("GET", "/get_pos", true);
  xhttp.send(); 
   }
   function load_items(){
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      let items = JSON.parse(this.responseText).items;
      let table=document.getElementById('items_table');
      let str='';
      items.forEach((item)=>{
       str += '<tr><td>'+item.name+'<input type="hidden" value="'+item.name+
       '"></td><td><input value="'+item.detail+'"  class="form-control" ></td><td><input value="'+item.price+'" type="number" class="form-control"></td><td><button class="btn btn-primary" onclick="edit_product(this)">Edit</button></td></tr></form>'
      });
      table.innerHTML = str;
     console.log(items);
    }
  };
  xhttp.open("GET", "/get_items", true);
  xhttp.send(); 
   }
   function edit_product(e){
    let product = e.parentNode.parentNode.getElementsByTagName('td')[0].getElementsByTagName('input')[0].value,
    details = e.parentNode.parentNode.getElementsByTagName('td')[1].getElementsByTagName('input')[0].value,
    price = e.parentNode.parentNode.getElementsByTagName('td')[2].getElementsByTagName('input')[0].value;
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        alert("product information is updated");
        window.location.reload();
    
    }
  };
  xhttp.open("POST", "/edit_item", true);
  xhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")
  xhttp.send("name="+product+"&details="+details+"&price="+price); 
   }
   function load_raw_items(){
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      let raw_items = JSON.parse(this.responseText).raw_items;
      let table=document.getElementById('raw_items_table');
      let str='';
      raw_items.forEach((raw_item)=>{
      //  <tr><td>'+item.name+'<input type="hidden" value="'+item.name+
      // '"></td><td><input value="'+item.detail+'"  class="form-control" ></td><td><input value="'+item.price+'" type="number" class="form-control"></td><td><button class="btn btn-primary" onclick="edit_product(this)">Edit</button></td></tr></form>'
    
       str += '<tr><td>'+raw_item.name+'('+raw_item.unit+')<input type="hidden" value="'+raw_item.name+
       '"></td><td><input value="'+raw_item.detail+
        '"  class="form-control" > </td><td><input value="'+raw_item.price
            +'"  class="form-control" ></td><td><button class="btn btn-primary" onclick="edit_raw_item(this)">Edit</button></td></tr>'
      });
      table.innerHTML = str;
     console.log(raw_items);
    }
  };
  xhttp.open("GET", "/get_raw_items", true);
  xhttp.send(); 
   }
   function edit_raw_item(e){
    let product = e.parentNode.parentNode.getElementsByTagName('td')[0].getElementsByTagName('input')[0].value,
    details = e.parentNode.parentNode.getElementsByTagName('td')[1].getElementsByTagName('input')[0].value,
    price = e.parentNode.parentNode.getElementsByTagName('td')[2].getElementsByTagName('input')[0].value;
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        alert("product information is updated");
        window.location.reload();
    
    }
  };
  xhttp.open("POST", "/edit_raw_item", true);
  xhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded")
  xhttp.send("name="+product+"&details="+details+"&price="+price); 
      
   }
   function load_styles(){
   
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      
        let styles = JSON.parse(this.responseText).styles;
        console.log("styles",styles);

      let table=document.getElementById('styles_table');
      let str='';
    //  str += '<tr><td>'+style.title+'</td><td>'+style.fabric_code+'</td><td>'+style.product+'</td><td>'+
      //      style.gender+'</td><td>'+style.details+'</td><td>'+style.measurements+
        //        '</td><td>'+style.logo+'</td><td><image src="'+style.picture+'" width="100px" /></td></tr>'
    
      styles.forEach((style)=>{
          console.log(style);
          let product_list = JSON.parse(style.product);
          let pro_text ='';
          product_list.forEach((product)=>{
            pro_text += `<div style='border:1px solid white'><div style="width:20%;display:inline;border:1px solid green">`+product.product+
                `</div><div style="width:20%;display:inline;border:1px solid green">`+product.fabric_code+
                `</div><div style="width:40%;display:inline;border:1px solid green">`+product.details+
                    `</div><div style="width:20%;display:inline;border:1px solid green" >`+product.logo+`</div></div><br>`
          })
       str += '<tr><td>'+style.title+'</td><td>'+style.gender+
        '</td><td style="overflow-x:scroll">'+pro_text+'</td><td><image src="'+style.picture+'" width="100px" /></td></tr>'
      });
      table.innerHTML = str;
    }
  };
  xhttp.open("GET", "/get_styles", true);
  xhttp.send(); 
   }  
   function load_fabrics(){
   
   var xhttp = new XMLHttpRequest();
 xhttp.onreadystatechange = function() {
   if (this.readyState == 4 && this.status == 200) {
     
       let fabrics = JSON.parse(this.responseText).fabrics;
       console.log("fabrics",fabrics);

     let table=document.getElementById('fabrics_table');
     let str='';
     fabrics.forEach((fabric)=>{
      str += '<tr><td>'+fabric.fabric_code+'</td><td>'+fabric.name+'</td><td>'+fabric.detail+'</td><td>'+
           fabric.width+'</td><td>'+fabric.color+'</td></tr>'
     });
     table.innerHTML = str;
   }
 };
 xhttp.open("GET", "/get_fabrics", true);
 xhttp.send(); 
  }    
   function load_clients(){
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      
        let clients = JSON.parse(this.responseText).clients;
      let table=document.getElementById('clients_table');
      let str='';
      clients.forEach((client)=>{
       str += '<tr><td>'+client.name+'</td><td>'+client.company_name+'</td><td>'+client.street+'</td><td>'+client.city+'</td><td>'+client.phone+'</td><td>'+client.email+'</td></tr>'
      });
      table.innerHTML = str;
     console.log(clients);
    }
  };
  xhttp.open("GET", "/get_clients", true);
  xhttp.send(); 
   }
   function load_vendors(){
    var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        let vendors = JSON.parse(this.responseText).vendors;
      let table=document.getElementById('vendors_table');
      let str='';
      vendors.forEach((vendor)=>{
       str += '<tr><td>'+vendor.name+'</td><td>'+vendor.company_name+'</td><td>'+vendor.street+'</td><td>'+vendor.city+'</td><td>'+vendor.phone+'</td><td>'+vendor.email+'</td></tr>'
      });
      table.innerHTML = str;
     console.log(vendors);

    }
  };
  xhttp.open("GET", "/get_vendors", true);
  xhttp.send(); 
   }
   load_styles(); 
   load_fabrics();                                    
   load_pos();
   load_lpos();
   load_items();
   load_raw_items();
   load_clients();
   load_vendors();
   function search(input,table){
    var input, filter, found, table, tr, td, i, j;
    input = document.getElementById(input);
    filter = input.value.toUpperCase();
    table = document.getElementById(table);
    tr = table.getElementsByTagName("tr");
    for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td");
        for (j = 0; j < td.length; j++) {
            if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
                found = true;
            }
        }
        if (found) {
            tr[i].style.display = "";
            found = false;
        } else {
            tr[i].style.display = "none";
        }
    }
}
</script>


</body>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
</html>