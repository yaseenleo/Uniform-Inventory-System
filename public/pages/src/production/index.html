<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Production Line</title>

    <link rel="stylesheet" href="../../../css/style.css">
    <link rel="stylesheet" href="../../../css/salesStyle.css">
    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">

    <meta name="description" content="Creative Button Styles  - Modern and subtle styles &amp; effects for buttons" />
    <meta name="keywords" content="button styles, css3, modern, flat button, subtle, effects, hover, web design" />
    <meta name="author" content="Codrops" />
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="css/default.css" />
    <link rel="stylesheet" type="text/css" href="css/component.css" />
    <script src='https://cdn.jsdelivr.net/npm/jsbarcode@3.8.0/dist/JsBarcode.all.min.js' ></script>
    <!-- Font Awesome -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>


    <div class="nav-side-menu">
            <div class="brand brand-color">
                <h5>Abbas Ali & Sons Uniforms and Textiles</h5>
            </div>
            <i class="fa fa-bars fa-2x toggle-btn" data-toggle="collapse" data-target="#menu-content"></i>
            <div class="menu-list" id="menu-content">
    
                    <ul id="accordion1" class="menu-content collapse out">

                            <li data-toggle="collapse" data-parent="#accordion1" href="#thirdLink"> <a> <i></i> Sales</a>
            
                                <ul id="thirdLink" class="collapse sub-list">
                                    <li>
                                        <a href="/sale/sales_order">Sales Order</a>
                                    </li>
                                    <li>
                                        <a href="/sale/packing_list">Packing List</a>
                                    </li>
                                    <li>
                                        <a href="/sale/commercial_invoice">Commercial Invoice</a>
                                    </li>
                                    <li>
                                        <a href="/sale/reciept_voucher">Reciept Voucher</a>
                                    </li>
                                </ul>
                            </li>
                            <li data-toggle="collapse" data-parent="#accordion1" href="#firstLink"> <a> <i></i> Purchase</a>
            
                                <ul id="firstLink" class="collapse sub-list">
                                    <li>
                                        <a href="/purchase/purchase_order">Purchase Order</a>
                                    </li>
                                    <li>
                                        <a href="/purchase/gr_note">Good Receiving Note / Invoice</a>
                                    </li>
            
                                    <li>
                                        <a href="/purchase/payment_voucher">Vendor Payment</a>
                                    </li>
                                </ul>
            
                            </li>
                            <li>
                                <a href="/production">
                                    <i></i> Production</a>
                            </li>
                            <li data-toggle="collapse" data-parent="#accordion1" href="#reports"> <a> <i></i> Reports</a>
            
                                <ul id="reports" class="collapse sub-list">
                                    <li>
                                        <a href="/reports/sales_report">Sales Report</a>
                                    </li>
                                    <li>
                                        <a href="/reports/purchase_report">Purchases Report</a>
                                    </li>
            
                                    <li>
                                        <a href="/reports/production_report">Productions Report</a>
                                    </li>
                                    <li>
                                        <a href="/reports/accounts_report">Accounts Report</a>
                                    </li>
                                </ul>
            
                            </li>
            
                            <li>
                                <a href="/master">
                                    <i></i> Master Data
                                </a>
                            </li>
            
                            <li>
                                <a href="/master_view">
                                    <i></i> Master View
            
                                </a>
                            </li>
            
                            <!-- <li>
                                    <a href="/attendance">
                                        <i></i> Attendance
                                    </a>
                                </li> -->
            
                        </ul>
            
    
            </div>
        </div>
    <div id="main" class="container-fluid">
        <div class="container production-container">
                <ul class="nav nav-tabs">
                        <li class="nav-item">
                          <a class="nav-link active" data-toggle="tab" href="#jsc">JOB SLIP CREATION</a>
                        </li>
                        <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#printing">JOB SLIPS PRINTING</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" data-toggle="tab" href="#operation">OPERATIONS</a>
                        </li>
                        
                        
                      </ul>
                      
                      <!-- Tab panes -->
                      <div class="tab-content">
                        <div class="tab-pane container active" id="jsc"> 
                            <div class="row" >
                                <h3>JOB SLIP CREATION</h3>
                                <div class='container'>
                                    <div class='col-md-12'>
                                            <div class='row' style="display:none">
                                                    <div class='col-md-4'><label class='form-control-label' style='margin-right:16px'>Starting Number#</label>
                        
                                                    </div>
                                                    <div class='col-md-6'>
                                                        <p class='form-control' id='starting_number_2'></p>
                                                        <input class='form-control' id='starting_number' name='starting_number' required hidden>
                                                    </div>
                                                </div>
                                        <div class='row'>
                                            <div class='col-md-4'><label class='form-control-label' style='margin-right:16px'>L.P.O
                                                    Ref:</label>
                
                                            </div>
                                            <div class='col-md-6'> <select class='form-control' required id='lpo_select' name='lpo_ref'>
                                                </select>
                                            </div>
                                        </div>
                                        <br>
                                          <div class='row'>
                                                <div class='col-md-4'> <label class='form-control-label' style='margin-right:16px'>Style:</label>
                                                </div>
                                                <div class='col-md-6'> <select required class='form-control' name='style' id="style_select" onChange="set_product_list(this)" >
                                                    </select>
                                                </div>
                                            </div> 
                                            <br>
                                           <div class="row">
                                               <table class="table table-striped table-light"><thead>
                                                   <tr><th>Product</th><th>Fabric Code</th>
                                                    <th>Details</th><th>Measurements</th>
                                                    <th>Quantity</th><th>Size</th>
                                                    <th>Person</th><th>&nbsp;</th></tr>
                                               </thead>
                                               <tbody id="product_list">

                                               </tbody>
                                            </table>
                                           </div> 
                                            
                                           
                                        </div>
                                    </div>
                                
                
                                </div></div>
                        <div class="tab-pane container fade" id="operation"><div class="row" >
                              <!----         left card section    -->
<div class='col-md-6'>
        <div class="card">
            <div class="card-header"><h5>Information About Job Slip</h5></div>
            <div class='card-body'>
                <div class='container-fluid'>
                        <!-- <div class='row'>
                                <div class="col-md-2">
                                        <label class='form-control-label'>LPO REF#</label>
                
                                </div>
                                <div class="col-md-4">
                                    <select id='unique_lpos2' name='number' onChange="js_set2(this)" class='form-control' required></select>
                                </div>          
                                <div class="col-md-2">
                                        <label class='form-control-label'>JOB SLIP#</label>
                
                                </div>
                                <div class="col-md-4">
                                    <select id='js_select' name='number' onChange='set_js()' class='form-control' required></select>
                                </div>
                            </div> -->
                            <!--- ammendment -->
                            <div class='row'>
                                <div class="col-md-2">
                                        <label class='form-control-label'>Client</label>
                
                                </div>
                                <div class="col-md-4">
                                    <select id='clients_select' name='number' onChange="lpo_set(this)" class='form-control' ></select>
                                </div>          
                                <div class="col-md-2">
                                        <label class='form-control-label'>LPO ref#</label>
                
                                </div>
                                <div class="col-md-4">
                                    <select id='s_lpo_select' class='form-control' ></select>
                                </div>
                            </div>
                            <!------  ammendment  -->
                            <hr/>
                    <table class='table table-dark table-striped' style="display: none">
                        <tr><td colspan="1">L.P.O ref</td><th id='ref' colspan="2"></th></tr>
                        <tr><td colspan="1">Product</td><th id='product' colspan="2"></th></tr>
                        <tr><td colspan="1">Style</td><th id='style' colspan="2"></th></tr>
                        <tr><td colspan="1">Total Quantity</td><th id='quantity' colspan="2"></th></tr>
                        <tr><td colspan="1">Starting Barcode Number</td><th colspan="2" id='starting_number_1'></th></tr>
                        <tr><td colspan="1">Quantity Delivered</td><td colspan="2" id="delivering_number"></td></tr>
                        <tr><td colspan="1">Quantity Cut</td><td colspan="2" id='cutting_number' >
                        </td></tr>
                        <tr><td>Cutting By:<span id="cutting_by"></span></td><td>Time:<span id="cutting_on"></span></td></tr>
                        <tr><td colspan="1">Quantity Stitch</td><td colspan="2" id='stitching_number'>
            
                            </td></tr>  
                        <tr><td>Stitching By:<span id='stitching_by'></span></td><td>Time:<span id="stitching_on"></span></td></tr>                        
                        <tr><td colspan="1">Quantity Finalized</td><td colspan="2" id='qc_number'>
                        </td></tr>
                        <tr><td>Finalised By:<span id="qc_by"></span></td><td>Time:<span id='qc_on'></span></td></tr>       
            
                        <tr><td colspan="1">Quantity Packed</td><td colspan="2" id='packing_number'>
                            </td></tr> 
                        <tr><td>Packing By:<span id="packing_by"></span></td><td>Time:<span id="packing_on"></span></td></tr>                          
                          </table>

                </div>

            </div>
        </div>
        </div> 
<!----         left card section    -->  
                             <div class='col-md-6'>
                                    <br>
                                    <ul class="nav nav-tabs">
                                            <li class="nav-item">
                                              <a class="nav-link active" data-toggle="tab" href="#cut">Cutting</a>
                                            </li>
                                            <li class="nav-item">
                                              <a class="nav-link" data-toggle="tab" href="#stitch">Stitching</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link" data-toggle="tab" href="#qc">Quality Checking</a>
                                              </li>
                                            <li class="nav-item">
                                                <a class="nav-link" data-toggle="tab" href="#pack">Packing</a>
                                              </li>
                                            <!-- <li class="nav-item">
                                                <a class="nav-link" data-toggle="tab" href="#deliver">Delivering</a>
                                             </li> -->
                                            
                                          </ul>
                                          <div class="tab-content">

                                           <!--- cutting phase -->
                                <div class="tab-pane container active" id='cut'>
                                        <div class="row">
                                               <div class='col-md-12'>
                                                      <br>
                                                      <h5>CUTTING DONE</h5>
                                                       
                                                           <br>
                                                           <div class='container-fluid'>
                                                                   <div class='row'>
                                                                       <div class="col-md-4">
                                                                               <label class='form-control-label'>Job Slip# / Job Slip Range</label>
       
                                                                       </div>
                                                                       <div class="col-md-6">
                                                                            <input required type='hidden' name='number' id='hidden_1' />

                                                                           <input required id='q_cut_input' type='text'  class='form-control'/>
                                                                       </div>
                                                                   </div>
                                                                   <br>
                                                                   <div class='row'>
                                                                        <div class="col-md-4">
                                                                                <label class='form-control-label'>Cut By(Person Incharge)</label>
        
                                                                        </div>
                                                                        <div class="col-md-6">
 
                                                                            <input required id='cutting_by_input' type='text'  class='form-control' />
                                                                        </div>
                                                                    </div>
                                                                   
                                                               </div>
                                                               <br>
                                                           <div class="container-fluid">
                                                               <div class="row">
                                                                   <div class="col-md-4">
                                                                       <button class="btn btn-primary" onclick="cutting_done(this)">Add</button>
                                                                   </div>
                                                               </div>
                                                           </div>    
                                                     </div>
                                                     <script>
                                                            function cutting_done(e){
                                                               // e.disabled = true;
                                                                let lpo_ref = document.getElementById("s_lpo_select").value,
                                                                     q = document.getElementById("q_cut_input").value,
                                                                     by = document.getElementById("cutting_by_input").value,
                                                                      d = new Date(),
                                                                       time = d.getDate() + "/" + (d.getMonth()+1) + "/" + d.getFullYear() + "--" + d.getHours() +":" + d.getMinutes(); 
      
                                                                    
                                                                     console.log("quantity:"+q);

                                                                     var xhttp = new XMLHttpRequest();
                                                                       xhttp.onreadystatechange = function () {
                                                                      if (this.readyState == 4 && this.status == 200) {

                                                                    //   let msg = JSON.parse(this.responseText).msg;
                                                                        alert('Success');
                                                                    //    alert(msg);
                                                                          
                                                                                  }
                                                                                  };
                                                                          xhttp.open("POST", "/job_slip/cutting", true);
                                                                          xhttp.setRequestHeader("content-type","application/x-www-form-urlencoded");
                                                                          xhttp.send("lpo_ref="+lpo_ref+"&q="+q+"&date="+time+"&by="+by);
                                                                         // location.reload();

      
                                                            }
                                                           </script>
                                       
                                       </div>
                                       </div>
                                    <!--- cutting phase -->
                                     <!--- stitching phase -->
                                <div class="tab-pane container fade" id='stitch'>
                                        <div class="row">
                                               <div class='col-md-12'>
                                                      <br>
                                                      <h5>STITCHING DONE</h5>
                                                       
                                                           <br>
                                                           <div class='container-fluid'>
                                                                   <div class='row'>
                                                                       <div class="col-md-4">
                                                                               <label class='form-control-label'>Job Slip# / Job Slip Range</label>
       
                                                                       </div>
                                                                       <div class="col-md-6">
                                                                           <input required type='hidden' name='number' id='hidden_2' />
                                                                           <input id='q_stitched_input' name='quantity' type='text'  class='form-control' required/>
                                                                       </div>
                                                                   </div>
                                                                   <br>
                                                                   <div class='row'>
                                                                        <div class="col-md-4">
                                                                                <label class='form-control-label'>Stitched By(Person Incharge)</label>
        
                                                                        </div>
                                                                        <div class="col-md-6">
 
                                                                            <input id='stitching_by_input' type='text'  class='form-control' />
                                                                        </div>
                                                                    </div>
                                                                   
                                                               </div>
                                                               <br>
                                                           <div class="container-fluid">
                                                               <div class="row">
                                                                   <div class="col-md-4">
                                                                       <button class="btn btn-primary" onClick="stitching_done(this)">Add</button>
                                                                   </div>
                                                               </div>
                                                           </div>    
                                                     </div>
                                                     <script>
                                                      function stitching_done(e){
                                                         // e.disabled = true;
                                                          let lpo_ref = document.getElementById("s_lpo_select").value,
                                                               q = document.getElementById("q_stitched_input").value,
                                                               by = document.getElementById("stitching_by_input").value,
                                                                d = new Date(),
                                                                 time = d.getDate() + "/" + (d.getMonth()+1) + "/" + d.getFullYear() + "--" + d.getHours() +":" + d.getMinutes(); 

                                                                
                                
                                                                     console.log("quantity:"+q);
                                                               var xhttp = new XMLHttpRequest();
                                                                 xhttp.onreadystatechange = function () {
                                                                if (this.readyState == 4 && this.status == 200) {
                                                               // let js_num = JSON.parse(this.responseText).js_num;
                                                             //   alert("job_slip is refreshed for js# "+js_num);
                                                               // location.reload();
                                                                    alert('Success')
                                                                            }
                                                                            };
                                                                    xhttp.open("POST", "/job_slip/stitching", true);
                                                                    xhttp.setRequestHeader("content-type","application/x-www-form-urlencoded");
                                                                    xhttp.send("lpo_ref="+lpo_ref+"&q="+q+"&date="+time+"&by="+by);
                                                                   // location.reload();

                                                      }
                                                     </script>
                                       
                                       
                                       </div>
                                       </div>
                                    <!--- stitching phase -->
                                     <!--- qc phase -->
                                <div class="tab-pane container fade" id='qc'>
                                    <div class="row">
                                           <div class='col-md-12'>
                                                  <br>
                                                  <h5>Quality Checked/Finalized</h5>
                                                   
                                                       <br>
                                                       <div class='container-fluid'>
                                                               <div class='row'>
                                                                   <div class="col-md-4">
                                                                           <label class='form-control-label'>Job Slip# / Job Slip Range</label>
   
                                                                   </div>
                                                                   <div class="col-md-6">
                                                                       <input required type='hidden' name='number' id='hidden_5' />
                                                                       <input id='q_qc_input'  type='text' min='0' class='form-control' />
                                                                   </div>
                                                               </div>
                                                               <br>
                                                               <div class='row'>
                                                                    <div class="col-md-4">
                                                                            <label class='form-control-label'>QC By(Person Incharge)</label>
    
                                                                    </div>
                                                                    <div class="col-md-6">

                                                                        <input required id='qc_by_input' type='text'  class='form-control' />
                                                                    </div>
                                                                </div>
                                                               
                                                           </div>
                                                           <br>
                                                       <div class="container-fluid">
                                                           <div class="row">
                                                               <div class="col-md-4">
                                                                   <button class="btn btn-primary" onClick="qc_done(this)">Add</button>
                                                               </div>
                                                           </div>
                                                       </div>    
                                                 </div>
                                                 <script>
                                                        function qc_done(e){
                                                           // e.disabled = true;
                                                           let lpo_ref = document.getElementById("s_lpo_select").value,
                                                                 q = document.getElementById("q_qc_input").value,
                                                                 by = document.getElementById("qc_by_input").value,
                                                                  d = new Date(),
                                                                   time = d.getDate() + "/" + (d.getMonth()+1) + "/" + d.getFullYear() + "--" + d.getHours() +":" + d.getMinutes(); 
  
                                                                   
  
                                  
                                                                       console.log("quantity:"+q);
                                                                 var xhttp = new XMLHttpRequest();
                                                                   xhttp.onreadystatechange = function () {
                                                                  if (this.readyState == 4 && this.status == 200) {
                                                                 // let js_num = JSON.parse(this.responseText).js_num;
                                                                 // alert("job_slip is refreshed for js# "+js_num);
                                                                //  location.reload();
                                                                   alert('Success');   
                                                                              }
                                                                              };
                                                                      xhttp.open("POST", "/job_slip/qc", true);
                                                                      xhttp.setRequestHeader("content-type","application/x-www-form-urlencoded");
                                                                      xhttp.send("lpo_ref="+lpo_ref+"&q="+q+"&date="+time+"&by="+by);
                                                                     // location.reload();

                                                        }
                                                       </script>
                                   
                                   </div>
                                   </div>
                                <!--- qc phase -->
                                     <!--- packed phase -->
                                <div class="tab-pane container fade" id='pack'>
                                        <div class="row">
                                               <div class='col-md-12'>
                                                      <br>
                                                      <h5>PACKING DONE</h5>
                                                       
                                                           <br>
                                                           <div class='container-fluid'>
                                                                   <div class='row'>
                                                                       <div class="col-md-4">
                                                                               <label class='form-control-label'>Job Slip# / Job Slip Range</label>
       
                                                                       </div>
                                                                       <div class="col-md-6">
                                                                            <input required type='hidden' name='number' id='hidden_3' />

                                                                           <input id='q_packed_input' name='quantity' type='text'  class='form-control' />
                                                                       </div>
                                                                   </div>
                                                                   <br>
                                                                   <div class='row'>
                                                                        <div class="col-md-4">
                                                                                <label class='form-control-label'>Packed By(Person Incharge)</label>
        
                                                                        </div>
                                                                        <div class="col-md-6">
 
                                                                            <input required id='packing_by_input' type='text'  class='form-control' />
                                                                        </div>
                                                                    </div>
                                                                   
                                                               </div>
                                                               <br>
                                                           <div class="container-fluid">
                                                               <div class="row">
                                                                   <div class="col-md-4">
                                                                       <button class="btn btn-primary" onclick="packing_done(this)">Add</button>
                                                                   </div>
                                                               </div>
                                                           </div>    
                                                       </form>
                                                     </div>
                                       
                                                     <script>
                                                        function packing_done(e){
                                                           // e.disabled = true
                                                           let lpo_ref = document.getElementById("s_lpo_select").value,
                                                                 q = document.getElementById("q_packed_input").value,
                                                                 by = document.getElementById("packing_by_input").value,
                                                                  d = new Date(),
                                                                   time = d.getDate() + "/" + (d.getMonth()+1) + "/" + d.getFullYear() + "--" + d.getHours() +":" + d.getMinutes(); 
  
                                                                 var xhttp = new XMLHttpRequest();
                                                                   xhttp.onreadystatechange = function () {
                                                                  if (this.readyState == 4 && this.status == 200) {
                                                                 // let js_num = JSON.parse(this.responseText).js_num;
                                                                //  alert("job_slip is refreshed for js# "+js_num);
                                                                //  location.reload();
                                                                   alert('Success') ;  
                                                                              }
                                                                              };
                                                                      xhttp.open("POST", "/job_slip/packing", true);
                                                                      xhttp.setRequestHeader("content-type","application/x-www-form-urlencoded");
                                                                      xhttp.send("lpo_ref="+lpo_ref+"&q="+q+"&date="+time+"&by="+by);
                                                                    //  location.reload();

                                                        }
                                                       </script>
                                       </div>
                                       </div>
                                    <!--- packed phase -->
                                     <!-- - delivered phase -->
                                <!-- <div class="tab-pane container fade" id='deliver'>
                                        <div class="row">
                                               <div class='col-md-12'>
                                                      <br>
                                                      <h5>READY TO DELIVER</h5>
                                                          <br>
                                                          <br>
                                        <a href="#" id='done_btn'><button class='btn btn-info'>Done!!!</button></a> 
                                                     </div>
                                       
                                       
                                       </div>
                                       </div> -->
                                    <!--- delivered phase -->
                                    </div>
                                                                                                     
   
                             </div>
                               
                
                                </div></div>
                            <!--- printing -->
                        <div class="tab-pane container fade" id='printing'>
                            <br>
                            <h4>Printing</h4>
                            <br>
                            <div class="row">
                                    <div class='col-md-5'>
                                            <div class='row'>
                                                   
                                                    <div class="col-md-2">
                                                            <label class='form-control-label'>LPO REF#</label>
                                    
                                                    </div>
                                                    <div class="col-md-4">
                                                        <select id='unique_lpos'  class='form-control' required onchange="js_set(this)"></select>
                                                    </div>
                                                    <div class="col-md-2">
                                                            <label class='form-control-label'>JOB SLIP#</label>
                                    
                                                    </div>
                                                    <div class="col-md-4">
                                                        <select id='js_select_1' name='number' class='form-control' required onchange="jsp_set(this)"></select>
                                                    </div>
                                                </div>
                                             <br>
                                             <div class='row'>
                                                   
                                                    <div class="col-md-4">
                                                            <label class='form-control-label'>LPO REF#</label>
                                    
                                                    </div>
                                                    <div class="col-md-6">
                                                        <span id='jsp_l'   ></span>
                                                    </div>
                                                </div>
                                                <div class='row'>
                                                   
                                                        <div class="col-md-4">
                                                                <label class='form-control-label'>Product</label>
                                        
                                                        </div>
                                                        <div class="col-md-6">
                                                            <span id='jsp_p'   ></span>
                                                        </div>
                                                    </div>
                                                    <div class='row'>
                                                   
                                                            <div class="col-md-4">
                                                                    <label class='form-control-label'>Starting#</label>
                                            
                                                            </div>
                                                            <div class="col-md-6">
                                                                <span id='jsp_s' ></span>
                                                            </div>
                                                        </div>  
                                                    <div class='row'>
                                                   
                                                            <div class="col-md-4">
                                                                    <label class='form-control-label'>Quantity</label>
                                            
                                                            </div>
                                                            <div class="col-md-6">
                                                                <span id='jsp_q' ></span>
                                                            </div>
                                                        </div>  
                                                        
                                               
                                                        <br>
                                                        <div class='row'>
                                                   
                                                                <div class="col-md-4">
                                                                        <label class='form-control-label'>Slips# Starting from</label>
                                                                </div>
                                                                <div class="col-md-6">
                                                                    <input id='printing_start_number' name='number' class='form-control' required min='1'></select>
                                                                </div>
                                                            </div>  
                                                            
                                             <div class='row'>
                                                   
                                                    <div class="col-md-4">
                                                            <label class='form-control-label'>Total Slips Quantity#</label>
                                    
                                                    </div>
                                                    <div class="col-md-6">
                                                        <input id='printing_quantity' name='number' class='form-control' required min='1'></select>
                                                    </div>
                                                </div>  
                                                
                                                <div class='row'>
                                                        <div class="col-md-4">
                                                                <button class='btn btn-primary' onClick='generate_slip()'>Print Job Slip</button>

                                                        </div>
                                                        <div class="col-md-4" style="margin-left:30px;">
                                                                <button class='btn btn-primary' onClick='generate_slips()'>Print Barcode Stickers</button>

                                                        </div>
                                                        
                                                    </div>
                                                       
                                    </div>
                                    <!----  printable area    -->
                                    <div class="col-md-7">
                                        <div class='container-fluid'>
                                            <div class="row" style='min-height: 400px;overflow: scroll;max-height: 800px'>
                                                <div class="col-md-12" id='printing_area'>
        
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12"><button class='btn btn-primary' id='print_btn' onclick="printDiv('printing_area')" disabled="true">Print</button></div>
                                            </div>
                                        </div>
        
                                    </div>
                                    <!----  printable area    -->
                            </div>
                            

                        </div>     
                        <!---- printing  -->   
                        

                      </div>
           
         </div>
    </div>
    </div>
</body>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>

<script src="../../../js/app.js"></script>

<!-- <script src="js/classie.js"></script> -->

<script src="../../../dist/jspdf.min.js"></script>

<script src="js/modernizr.custom.js"></script>
<script>
    let lpos, products,job_slips,styles;
    function set_product_list(e){
        let text='';
        styles.forEach((style)=>{
            if(style.title===e.value)
            {
                
                
                let product_list = JSON.parse(style.product);
                product_list.forEach((product)=>{
                    text += `<tr>
                        <td>`+product.product+`</td><td>`+product.fabric_code+`</td>
                        <td>`+product.details+`</td><td><textarea rows='4' class='form-control'></textarea></td>
                        <td><input type="number" class="form-control"></td>
                        <td style='width:150px'><select class="form-control">
                                <option value="">Select Size</option>
                                <option value="s">Small</option>
                                <option value="m">Medium</option>
                                <option value="l">Large</option>
                                <option value="xl">X Large</option>

                            </select></td>
                        <td><input class="form-control"></td><td><button class="btn btn-primary" onClick="create_job_slip(this)">Create Job Slip</button></td>
                        </tr>`
                })
            }
        });
        document.getElementById("product_list").innerHTML = text;
        console.log(text);
    }
    function create_job_slip(e){
        e.disabled = true;
        let lpo_ref = document.getElementById("lpo_select").value
         sn = document.getElementById("starting_number").value ,
         ss = document.getElementById("style_select").value,
         p=e.parentNode.parentNode.getElementsByTagName("td")[0].innerHTML,
         q=e.parentNode.parentNode.getElementsByTagName("td")[4].getElementsByTagName("input")[0].value,
         s=e.parentNode.parentNode.getElementsByTagName("td")[5].getElementsByTagName("select")[0].value,
         pe=e.parentNode.parentNode.getElementsByTagName("td")[6].getElementsByTagName("input")[0].value,
          m = e.parentNode.parentNode.getElementsByTagName("td")[3].getElementsByTagName("textarea")[0].value,
          d = new Date().getTime();
         if(lpo_ref==="")
        {
            alert("please select LPO ref");
        }
        else if(p ==="" || q ==="" || s==="" || pe==="" || m ===""){
            alert("please fill measurements,quantity,size and person!!");

        }
        else{
            var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                let js_num = JSON.parse(this.responseText).js_num;
                e.disabled = false;
                e.parentNode.parentNode.getElementsByTagName("td")[4].getElementsByTagName("input")[0].value='';
         e.parentNode.parentNode.getElementsByTagName("td")[5].getElementsByTagName("select")[0].value='';
         e.parentNode.parentNode.getElementsByTagName("td")[6].getElementsByTagName("input")[0].value='';
         e.parentNode.parentNode.getElementsByTagName("td")[3].getElementsByTagName("textarea")[0].value='';
               alert("job slip is created for lpo ref#"+lpo_ref+" for "+q+" "+p );
            }
        };
        xhttp.open("POST", "/create_job_slip", true);
        xhttp.setRequestHeader("content-type","application/x-www-form-urlencoded");
        xhttp.send("lpo_ref="+lpo_ref+"&sn="+sn+"&ss="+ss+"&q="+q+"&p="+p+"&s="+s+"&pe="+pe+"&m="+m+"&d="+d);


        }
        
    }
    function load_lpos_styles() {
        var xhttp3 = new XMLHttpRequest();
        xhttp3.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                lpos = JSON.parse(this.responseText).lpos;
                str = '<option value="">Select L.P.O</option>';
                // alert(e.innerHTML.length)
                lpos.forEach((lpo) => {
                    str += `<option value="`+lpo.ref+`">` + lpo.ref + `</option>`;
                });
                document.getElementById('lpo_select').innerHTML = str;

                console.log(lpos)
            }
        };
        xhttp3.open("GET", "/get_lpos", true);
        xhttp3.send();
        ////

          var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
               styles = JSON.parse(this.responseText).styles;
                str = '<option >Select Style</option>';
                // alert(e.innerHTML.length)
                styles.forEach((style) => {
                    str += `<option value='`+style.title+`'>` + style.title+ `</option>`;
                });
                document.getElementById('style_select').innerHTML = str;

            }
        };
        xhttp.open("GET", "/get_styles", true);
        xhttp.send();
        ///////////////
        var xhttp2 = new XMLHttpRequest();
        xhttp2.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
               let info = JSON.parse(this.responseText).info;
                console.log(info);
                document.getElementById('starting_number').value = (info[0].last_number)+ 1;
                document.getElementById('starting_number_2').innerHTML = (info[0].last_number)+ 1;

            }
        };
        xhttp2.open("GET", "/get_info", true);
        xhttp2.send();
        ////
        
        var xhttp4 = new XMLHttpRequest();
        xhttp4.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                job_slips = JSON.parse(this.responseText).job_slips;
               // str = '<option value="null">Select Job Slip #</option>';
                // job_slips.reverse().forEach((job_slip) => {
                //     str += `<option value='`+job_slip.number+`'>`+job_slip.ref+"/js#" + job_slip.style + `</option>`;
                // });
                // document.getElementById('js_select').innerHTML = str;
                // document.getElementById('js_select_1').innerHTML = str;
                console.log("job_slip",job_slips);
                let unique_lpos = [];
                job_slips.forEach((js)=>{
                    if(unique_lpos.indexOf(js.ref) === -1){
                        unique_lpos.push(js.ref);
                    }
                });
                let u_lpo ='<option value="">Select LPO</option>';
                unique_lpos.forEach((lpo)=>{
                    u_lpo += `<option value="`+lpo+`">`+lpo+`</option>`
                });
                document.getElementById("unique_lpos").innerHTML = u_lpo;
                document.getElementById("unique_lpos2").innerHTML = u_lpo;
                console.log("unique_lpo",unique_lpos);

            }
        };
        xhttp4.open("GET", "/get_job_slips", true);
        xhttp4.send();

        //// clients list

        var xhttp6 = new XMLHttpRequest();
        xhttp6.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
               clients = JSON.parse(this.responseText).clients;
                let c_text = '<option value="">Select Client</option>';
                // alert(e.innerHTML.length)
                clients.forEach((client) => {
                    c_text += `<option value='`+client.company_name+`'>` + client.company_name+ `</option>`;
                });
                document.getElementById('clients_select').innerHTML = c_text;

            }
        };
        xhttp6.open("GET", "/get_clients", true);
        xhttp6.send();

    }
    function lpo_set(e){
       let select = document.getElementById("s_lpo_select");
       let lpos_txt = '<option value="">Select LPO</option>';
       let company_name = e.value;
       console.log("lpos",lpos);
       lpos.forEach((lpo)=>{
        if(lpo.client===company_name)
            {
               lpos_txt += `<option value="`+lpo.ref+`">`+lpo.ref+`</option>` 
            }
       });
       select.innerHTML = lpos_txt;
    }
    function js_set(e){
        jsp_set("");
       let js = document.getElementById("js_select_1");
       let js_html='<option value="">Select Job Slip</option>';
       job_slips.forEach((js)=>{
           if(js.ref===e.value){
               js_html += `<option value="`+js.number+`">`+js.number+`</option>`
           }
       })
       js.innerHTML = js_html;
    }
    function js_set2(e){
    //     jsp_set("");
       let js = document.getElementById("js_select");
       let js_html='<option value="">Select Job Slip</option>';
       job_slips.forEach((js)=>{
           if(js.ref===e.value){
               js_html += `<option value="`+js.number+`">`+js.number+`</option>`
           }
       })
       js.innerHTML = js_html;
    //alert(e.value);
    }
    // function load_products() {
    //     let product_select = document.getElementById('product_select');
    //     let company_name = document.getElementById('company_name');
    //     let lpo_select = document.getElementById('lpo_select');
    //     lpos.forEach((lpo) => {
    //         if (lpo.ref === lpo_select.value) {
    //             products = JSON.parse(lpo.items_array);
    //             let str = '<option>Select Product</option>'
    //             products.forEach((product) => {
    //                 str += `<option value='` + product.item + `'>` + product.item + `</option>`
    //             })
    //             product_select.innerHTML = str;
    //             company_name.value = lpo.client
    //             // alert(products);
    //         }
    //     })
    // }
    // function set_product() {
    //     let quantity = document.getElementById('product_quantity');
    //     let product_value = document.getElementById('product_select').value;
    //     products.forEach((product) => {
    //         if (product.item === product_value) {
    //             quantity.value = product.quantity;
    //         }
    //     })
    // }
    function set_js(){
        job_slips.reverse().forEach((js)=>{
            if(js.number===document.getElementById('js_select').value)
            {
                console.log(js);
                document.getElementById('hidden_1').value = js.number;
                document.getElementById('hidden_2').value = js.number;
                document.getElementById('hidden_3').value = js.number;
                document.getElementById('hidden_5').value = js.number;


                document.getElementById('ref').innerHTML = js.ref;
                document.getElementById('product').innerHTML = js.product;
                document.getElementById('style').innerHTML = js.style;
                document.getElementById('quantity').innerHTML = js.quantity;
                document.getElementById('starting_number_1').innerHTML = js.starting_number;
                document.getElementById('cutting_number').innerHTML = js.cutting;
                document.getElementById('cutting_by').innerHTML = js.cutting_by;
                document.getElementById('stitching_by').innerHTML = js.stitching_by;
                document.getElementById('packing_by').innerHTML = js.packing_by;
                document.getElementById('qc_by').innerHTML = js.qc_by;
                document.getElementById('cutting_on').innerHTML = js.cutting_on;
                document.getElementById('stitching_on').innerHTML = js.stitching_on;
                document.getElementById('packing_on').innerHTML = js.packing_on;
                document.getElementById('qc_on').innerHTML = js.qc_on;


                document.getElementById('stitching_number').innerHTML = js.stitching;
                document.getElementById('packing_number').innerHTML = js.packing;
                document.getElementById('delivering_number').innerHTML = js.delivered;
                document.getElementById('qc_number').innerHTML = js.qc;
                document.getElementById("q_cut_input").setAttribute("max",(parseInt(js.quantity)-parseInt(js.cutting)));
               document.getElementById("q_stitched_input").setAttribute("max",(parseInt(js.cutting)-parseInt(js.stitching)));
              document.getElementById("q_qc_input").setAttribute("max",(parseInt(js.stitching)-parseInt(js.qc)));
              document.getElementById("q_packed_input").setAttribute("max",(parseInt(js.qc)-parseInt(js.packing)));
               // document.getElementById("done_btn").setAttribute("href","/job_slip/complete/"+js.number);
            }
        })
    }
    load_lpos_styles();
</script>
<script> 
         function generate_slip(){
             let number =  document.getElementById('js_select_1').value;
             let start = document.getElementById('printing_start_number').value;
           let quantity =  document.getElementById('printing_quantity').value;
             job_slips.reverse().forEach((job_slip)=>{
                if(job_slip.number===number)
                {  
                    if(job_slip.quantity>=quantity && start >= job_slip.starting_number){

                    let d = new Date(),str='';
                    
                  let date = d.getDate() +"/"+ (d.getMonth() + 1) +"/"+ d.getFullYear(), 
                    item = job_slip.product,
                    lpo = job_slip.ref,
                    //js_num = job_slip.number,
                    person = job_slip.person,
                    size = job_slip.size,
                    company = job_slip.ref.split("/")[1],
                    style = job_slip.style,
                    style_details;
                    styles.forEach((style_)=>{
                        if(style_.title===style){
                            style_details = style_.details
                        }
                      });
                      for( let i = 1 ; i<=quantity ; i ++)
                      {
                        js_num = parseInt(start) + (i-1);

                        str += `
                    <div style="width: 900px;">
                    <div style="width: 100%;display: block;border-bottom: 1px dashed black;">
                    <h2 style="text-align: center">DREAM UNIFORM LLC</h2>
                    <h3 style="text-align: center;margin-top: -20px;margin-bottom: 0px">PRODUCTION DEPARTMENT / JOB SLIP</h3>
                    </div>
                    <h4 style="text-align: center;margin-top: 5px">Wages line</h4>
                    <div style="width: 100%;display: block;padding-left:30px;padding-right:30px;">
                    <table border="0" style="width:100%;margin-bottom: 100px">
                    <tr><td width="10%">DATE</td><td width="40%">${date}</td><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">SLIP #</td><td width="40%">${js_num}</td><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%" style="vertical-align: text-top">COMPANY</td><td width="40%" style="vertical-align: text-top">${company}</td><td width="10%" style="vertical-align: text-top">LPO#</td><td width="40%" style="vertical-align: text-top">${lpo}</td></tr>
                    <tr><td width="10%" style="vertical-align: text-top">PERSON</td><td width="40%" style="vertical-align: text-top">${person}</td><td width="10%" style="vertical-align: text-top">DEP/DES</td><td width="40%" style="vertical-align: text-top">${person}</td></tr>
                    <tr><td width="10%" style="vertical-align: text-top">ITEM</td><td width="40%" style="vertical-align: text-top">${item}</td><td width="10%" style="vertical-align: text-top">STYLE</td><td width="40%" style="vertical-align: text-top">${style}</td></tr>
                    <tr><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td><td width="10%">&nbsp;</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">QTY</td><td width="40%">${number}</td><td width="10%">SIZE</td><td width="40%">${size}</td></tr>
                    <tr><td width="10%">EMB</td><td width="40%"></td><td width="10%">SPEC NO.</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">Style Status</td><td width="40%"></td><td width="10%">PATTERN#</td><td width="40%">&nbsp;</td></tr>
                    <tr><td width="10%">Wash Code</td><td width="40%">WC0</td><td width="10%">TRIAL</td><td width="40%">No</td></tr>
                    <tr><td width="10%" style="vertical-align: text-top">Style Detailing</td><td width="40%" style="vertical-align: text-top;word-wrap: break-word">
                    ${style_details}
                    </td></tr>
                </table>
                <div style="width: 100%;margin-bottom: 10px;">
                    <div style="width:50%;display: inline;">Cutting Date/Cut By <span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ </span></div>
                    <div style="width:50%;display: inline;float: right;">Stitching <span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ </span></div>
                </div>
                <div style="width: 100%;margin-bottom: 10px;">
                        <div style="width:50%;display: inline;">Quality Check Date/Quality Check By <span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ </span></div>
                        <div style="width:50%;display: inline;float: right;">Recieved in Store By <span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ </span></div>
                </div>
                <div style="width: 100%;margin-bottom: 10px;">
                        <div style="width:50%;display: inline;">Store Recieving Date <span>_ _ _ _ _ _ _ _ _ _ _ _ _ _ </span></div>
                        <div style="width:50%;display: inline;float: right;">JOB SLIP PRINT DATE <span> ${date}</span></div>
                </div>
            </div>
   </div>
   <br><hr>`;
                      }
                      
                    document.getElementById("printing_area").innerHTML = str;  
                    document.getElementById("print_btn").disabled = false;
                   // alert(JSON.stringify(job_slip));
                
              }
              else{
                alert(`quantity must be equal or less than ${job_slip.quantity} and starting sequence should be equal or greater than ${job_slip.starting_number}`);
              }
            }
            })

         };
        function generate_slips(){
           let start = document.getElementById('printing_start_number').value;
           let number =  document.getElementById('js_select_1').value;
           let quantity =  document.getElementById('printing_quantity').value;
           let printing_area = document.getElementById('printing_area');
           job_slips.forEach((job_slip)=>{
               if(job_slip.number===number)
               {   
                 if(job_slip.quantity>=quantity && start >= job_slip.starting_number){
                     let barcode_num ,qty,item,lpo,style,company,str='';
                     item = job_slip.product;
                    style = job_slip.style;
                    lpo = job_slip.ref;
                    company = job_slip.ref.split("/")[1];
                    console.log(company);

                   for(let i=1 ; i<= quantity ; i++ )
                   {
                    qty = i;

                    str += `<div class="container">
                <div class="container-fluid">
                    <div class="row">
                            <div class="col-md-12">
                               <image id='img_`+i+`' />
                                </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-3">Qty#</div>
                        <div class="col-md-9">1</div>
                    </div>
                    <div class="row">
                            <div class="col-md-3">Item</div>
                            <div class="col-md-9">`+item+`</div>
                    </div>
                    <div class="row">
                            <div class="col-md-3">LPO#</div>
                            <div class="col-md-9">`+lpo+`</div>
                    </div>
                    <div class="row">
                            <div class="col-md-3">Style</div>
                            <div class="col-md-9">`+style+`</div>
                    </div>
                    <div class="row">
                            <div class="col-md-3">Company</div>
                            <div class="col-md-9">`+company+`</div>
                    </div>
                    <div class="row">
                            <div class="col-md-12"><span>----------------------</span></div>
                           
                    </div>
                </div>
                <br>
            </div>
                    `

                    
                   }
                   printing_area.innerHTML = str;
                   for(let i = 1 ; i<= quantity ; i++)
                   {
                    barcode_num = parseInt(start) + (i-1);

                    JsBarcode("#img_"+i, barcode_num);

                   }
                   alert("Product Stickers are ready to be printed");
                   document.getElementById("print_btn").disabled = false;


                   
                
                
                }
                   else{
                       alert(`quantity must be equal or less than ${job_slip.quantity} and starting sequence should be equal or greater than ${job_slip.starting_number}`);
                   }
                   
               }
           }) 
            
        }
        function printDiv(divName) {
     var printContents = document.getElementById(divName).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
}
function jsp_set(e){
    let lpo = document.getElementById('jsp_l'),
   product =   document.getElementById('jsp_p'),
   quantity =  document.getElementById('jsp_q') ,
   starting =  document.getElementById('jsp_s') ;
   lpo.innerHTML = "";
           product.innerHTML = "";
           quantity.innerHTML = "";
           starting.innerHTML = "";
    

//    alert(e.value);
   job_slips.forEach((job_slip)=>{
       if(job_slip.number === e.value){
           lpo.innerHTML = job_slip.ref;
           product.innerHTML = job_slip.product;
           quantity.innerHTML = job_slip.quantity;
           starting.innerHTML = job_slip.starting_number;
       }
   })

    
}

        </script>  
        

</html>